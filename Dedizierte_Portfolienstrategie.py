from two_phase_simplex import TwoPhaseSimplex
import numpy as np

if __name__ == "__main__":

    #Add Input in Standardform here:
    
    c = [103.41, 105.41, 101.95,    #Dedizierte Portfoliostrategie
         107.49, 103.18, 103.20,
         103.39, 102.85, 103.32,
         103.33, 116.98, 99.95,
         117.90, 108.31, 108.74,
         107.87, 107.50, 108.52,
         108.52, 130.24, 107.80,
         108.74, 108.47, 110.09,
         113.41, 112.42, 110.63,
         107.24, 107.54, 137.49,
         139.54, 101.25, 100.29,
         140.56, 140.12, 116.43,
         117.75, 138.69, 137.76,
         120.56
        ]
    b = [6000000, 6000000, 9000000, 9000000,
         10000000, 10000000, 10000000, 10000000,
         8000000, 8000000, 8000000, 8000000,
         6000000, 6000000, 5000000, 5000000]
    A = [[107.875, 108.125, 102.625, 8.125, 2.625, 2.500, 2.250, 1.750, 1.750, 1.625, 7.125, 0.125, 6.250, 2.875, 2.875,
          2.500, 2.250, 2.500, 2.375, 7.500, 2.000, 2.125, 2.000, 2.250, 2.875, 2.625, 2.250, 1.625, 1.625, 6.500,
          6.625, 0.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 108.125, 102.625, 2.500, 2.250, 1.750, 1.750, 1.625, 7.125, 0.125, 6.250, 2.875, 2.875,
          2.500, 2.250, 2.500, 2.375, 7.500, 2.000, 2.125, 2.000, 2.250, 2.875, 2.625, 2.250, 1.625, 1.625, 6.500,
          6.625, 0.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 102.500, 102.250, 101.750, 1.750, 1.625, 7.125, 0.125, 6.250, 2.875, 2.875,
          2.500, 2.250, 2.500, 2.375, 7.500, 2.000, 2.125, 2.000, 2.250, 2.875, 2.625, 2.250, 1.625, 1.625, 6.500,
          6.625, 0.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 101.750, 101.625, 7.125, 0.125, 6.250, 2.875, 2.875,
          2.500, 2.250, 2.500, 2.375, 7.500, 2.000, 2.125, 2.000, 2.250, 2.875, 2.625, 2.250, 1.625, 1.625, 6.500,
          6.625, 0.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 107.125, 100.125, 6.250, 2.875, 2.875,
          2.500, 2.250, 2.500, 2.375, 7.500, 2.000, 2.125, 2.000, 2.250, 2.875, 2.625, 2.250, 1.625, 1.625, 6.500,
          6.625, 0.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 106.250, 102.875, 102.875,
          2.500, 2.250, 2.500, 2.375, 7.500, 2.000, 2.125, 2.000, 2.250, 2.875, 2.625, 2.250, 1.625, 1.625, 6.500,
          6.625, 0.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          102.500, 102.250, 102.500, 2.375, 7.500, 2.000, 2.125, 2.000, 2.250, 2.875, 2.625, 2.250, 1.625, 1.625, 6.500,
          6.625, 0.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 102.375, 107.500, 2.000, 2.125, 2.000, 2.250, 2.875, 2.625, 2.250, 1.625, 1.625, 6.500,
          6.625, 0.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0, 102.000, 102.125, 2.000, 2.250, 2.875, 2.625, 2.250, 1.625, 1.625, 6.500,
          6.625, 0.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0, 0, 0, 102.000, 102.250, 102.875, 2.625, 2.250, 1.625, 1.625, 6.500,
          6.625, 0.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 102.625, 102.250, 101.625, 1.625, 6.500,
          6.625, 0.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 101.625, 106.500,
          6.625, 0.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          106.625, 100.625, 0.500, 6.375, 6.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 100.500, 106.375, 106.125, 2.750, 2.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0, 102.750, 102.875, 5.500, 5.250, 3.125],
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0, 0, 0, 105.500, 105.250, 103.125]]

    algo = TwoPhaseSimplex()
    z, b_hat, indices, delta_b, delta_c_B, reduced_costs, shadow_prices = algo.two_phase_simplex(c, b, A)
    indices_ = np.array(indices) + 1

    print("Results:")
    print("z: {}".format(z))
    print("Indices: {}".format(str(indices_)))
    print("x_B: {}".format(str(b_hat)))

    print("Sensitivity:")
    print("Reduced costs: {}".format(str(reduced_costs)))
    print("Delta c: {}".format(delta_c_B))
    print("Delta b: {}".format(delta_b))
    print("Shadow prices: {}".format(shadow_prices))




    #Output:


    # Results:

    # z: 104207901.26309052
    # Indices: [ 1  4  6  9 11 13 16 20 22 25 26 30 31 34 37 38  2  3  5  7  8 10 12 14
    #           15 17 18 19 21 23 24 27 28 29 32 33 35 36 39 40]
    # x_B: [18802.50777969 20283.20526734 51931.21569531 53229.4960877
    #       64161.01226923 68732.48439341 73028.264668   74853.9712847
    #       60468.01913105 61752.96453759 63528.36226805 65195.98177758
    #       49433.72059312 52708.70458242 46068.88449955 47393.36492891]

    #Sensitivity:

    # Reduced costs: [ 1.76034762  3.57269988  6.03386336  0.90041523  1.78124568  0.48602714
    #                  15.49846651  8.91587556  9.34587556  1.23046888  0.65       15.00968553
    #                  0.07030207  2.89907848  2.27934177  1.89446291  4.64523443 21.31822098
    #                  28.74094856 29.19403804  2.51591651  0.25972856  2.39339537 13.44225606]
    # Delta c: [(-87.62892456460379, 1.7562774566473986), (-81.23191153149834, 6.35723728093514),
    #           (-75.12777945109666, 0.902616730893189), (-73.29539458643602, 0.48662495777197534),
    #           (-72.03478583433491, 16.58200474522542), (-67.24367405772232, 9.20837694546884),
    #           (-63.28816381903292, 0.6499999999999915), (-61.744550067349074, 15.761086145007436),
    #           (-278.39591344824515, 0.07038822397098599), (-272.60309762374027, 2.293274178357353),
    #           (-264.984785053455, 1.9014108194277402), (-258.20685510689833, 22.34086627179775),
    #           (-242.44775127408283, 30.454694563236306), (-227.38358853372432, 2.521843288654202),
    #           (-614.2863398354804, 0.2600445315901127), (-inf, 2.399080399250879)]
    # Delta b: [(-2028320.5267341873, inf), (-2193121.56953134, 26992265.47115495),
    #           (-5322949.608769624, 89917984.35078493), (-5416101.226923091, 130702212.96703383),
    #           (-6873248.439341362, 34389586.6486507), (-7302826.466800197, 41654386.82817816),
    #           (-7485397.128470205, 106739366.24720652), (-8046801.913105468, 38248272.905249),
    #           (-6175296.453758958, 137862524.83936077), (-6352836.226804529, 104827966.57758133),
    #           (-6519598.177758148, 117825386.48121834), (-6943372.0593124265, 50676245.55100862),
    #           (-5270870.458241875, 53014045.93539005), (-5606888.449954795, 58605208.67215435),
    #           (-4739336.492890995, 133686762.15197472), (-5000000.0, 73725210.99131058)]
    # Shadow prices: [0.9586097615965578, 0.9220940668459935, 0.9609584767341398, 0.9665561954551487,
    #                 0.8387066738591314, 0.8362985891863448, 0.9186531089260909, 0.764892406583075,
    #                 0.9156486405292426, 0.8765302686251907, 0.8662875933563086, 0.6913237092333723,
    #                 0.6552664794916888, 0.6518412543040634, 0.8141624252972927, 0.6557530153715643]
